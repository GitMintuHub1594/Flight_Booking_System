<template>
    <lightning-card title="Flight Booking System">
        <div class="slds-m-around_medium">
            <lightning-input type="text" label="Departure From" value={departureFrom} onchange={handleDepartureFromChange}></lightning-input>
            <lightning-input type="text" label="Arrival To" value={arrivalTo} onchange={handleArrivalToChange}></lightning-input>
            <lightning-input type="date" label="Departure Date" value={departureDate} onchange={handleDateChange}></lightning-input>
        </div>
        <lightning-button label="Search Flights" variant="brand" onclick={handleSearch} class="slds-m-top_medium slds-grid slds-grid_align-center"></lightning-button>
    </lightning-card>
    <br>
    <template if:true={showFlights}>
        <lightning-card title="Available Flights">
            <template if:true={flightList.length}>
                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                    <thead>
                        <tr>
                            <th>Airlines Name</th>
                            <th>Departure From</th>
                            <th>Arrival To</th>
                            <th>Departure Date</th>
                            <th>Price</th>
                            <th>Click To Book</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template for:each={flightList} for:item="airline">
                            <tr key={airline.Id}>          <!-- data-id={airline.Id} is Custom Data Attribute: Explanation on Execl Sheet-->
                            <td>{airline.Name}</td>
                                <td>{airline.City_From__c}</td>
                                <td>{airline.City_To__c}</td>
                                <td>{airline.Departure_Date__c}</td>
                                <td>{airline.Price__c}</td>
                                <td><lightning-button label="Book" variant="brand" onclick={handleBook} data-flight-id={airline.Id}></lightning-button></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>
            <template if:false={flightList.length}>
                <p class="slds-m-around_medium slds-grid slds-grid_align-center">No flights found for the given details.</p>
            </template>
        </lightning-card>
    </template>
    <br>
<!-- Modal Starts-->
    <template if:true={selectedFlight}>
        <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
            <!-- Close button -->
            <button class="slds-button slds-modal__close" title="Close" onclick={handleCancelBooking}>
                <lightning-icon icon-name="utility:close"
                                    alternative-text="close"
                                    variant="bare"
                                    size="small"></lightning-icon>
            </button>
            <!-- Header -->
            <header class="slds-modal__header">
                <h2 class="slds-text-heading_medium">Booking Details</h2>
            </header>
            <!-- Body -->
            <div class="slds-modal__content slds-p-around_medium">
                <div class="slds-m-around_medium">
                    <p><strong>Airline Name:</strong> {selectedFlight.Name}</p>
                    <p><strong>From:</strong> {selectedFlight.City_From__c}</p>
                    <p><strong>To:</strong> {selectedFlight.City_To__c}</p>
                    <p><strong>Date:</strong> {selectedFlight.Departure_Date__c}</p>
                    <p><strong>Price:</strong> {selectedFlight.Price__c}</p>
                    <lightning-input label="Name" type="text" value={Name} onchange={handleName} required="true"></lightning-input>
                    <lightning-input label="Email" type="email" value={Email} onchange={handleEmail} required="true"></lightning-input>
                    <lightning-input label="Phone" type="tel" value={Phone} onchange={handlePhone}></lightning-input>
                </div>
            </div>
            <!-- Footer -->
            <footer class="slds-modal__footer">
                <div class="slds-m-around_medium">
                    <lightning-button label="Confirm Booking" variant="success" onclick={handleConfirmBooking}></lightning-button>
                    <lightning-button label="Cancel" variant="destructive" class="slds-m-left_small" onclick={handleCancelBooking}></lightning-button>
                </div>
            </footer>
        </div>
        </section>
        <!-- Backdrop -->
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
<!--Modal Ends-->
</template>



